<?xml version="1.0" encoding="UTF-8"?>
<project default="build" name="SimME">
    <property name="deploy-14.dir" value="D:/Devel/j2me-wtk104/apps/SimME"/>
    <property name="deploy-14.srcdir" value="${deploy.dir}/src"/>

    <property name="deploy-2.dir" value="D:/Devel/j2me-wtk/apps/SimME"/>
    <property name="deploy-2.srcdir" value="${deploy2.dir}/src"/>

    <property name="src" value="src"/>
    <property name="cls" value="cls"/>
    <property name="client-package" value="test/sim"/>

    <!-- misc libraries for building -->
    <property name="lib.junit" value="../lib/junit.jar"/>
    <property name="lib.midp" value="../lib/midpapi.zip"/>

    <target name="initbuild">
        <path id="project.class.path">
            <pathelement path="${lib.midp}"/>
            <pathelement path="${lib.junit}"/>
        </path>
        <mkdir dir="${cls}"/>
    </target>
    
    <!-- build simme -->
    <target name="compile" depends="initbuild">
        <javac srcdir="${src}" destdir="${cls}">
            <classpath refid="project.class.path"/>
        </javac>
    </target>

    <!-- delete created classes -->
    <target name="clean">
        <delete dir="${cls}"/>
    </target>
    
    <target name="build" depends="compile">
        <description>
            Creates the simme-client libraries, without test classes.
        </description>
        <jar destfile="../lib/simme-client.jar" index="true" update="true">
            <fileset dir="${cls}">
                <!-- omitting test classes -->
                <patternset id="non.test.classes">
                    <include name="**/*.class"/>
                    <exclude name="**/*Test*"/>
                    <exclude name="**/tests/*"/>
                </patternset>
            </fileset>
        </jar>
    </target>

    <!-- deployment to wtk-104 -->
    <target name="deploy">
      <copy todir="${deploy-14.srcdir}">
        <fileset dir="${src}">
          <include name="${client-package}/**/*.java"/>
          <include name="nanoxml/*.java"/>
        </fileset>
      </copy>
    </target>

    <!-- deployment to wtk-2.0 -->
    <target name="deploy2">
      <copy todir="${deploy-2.srcdir}">
        <fileset dir="${src}">
          <include name="${client-package}/**/*.java"/>
          <include name="nanoxml/*.java"/>
        </fileset>
      </copy>
    </target>
</project>
